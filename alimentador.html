<!DOCTYPE html>
<html>
<head>
<script src="https://code.jquery.com/jquery-1.7.2.min.js" type="text/javascript" charset="utf-8"></script>

<script>
var accessToken = "5ab97d510e2356b04c0e2646d3b14ba1cf489948";
var deviceID = "3b001b001547313036303933";
var url = "https://api.particle.io/v1/devices/" + deviceID + "/led";

function switchOn() {
    $.post(url, { params: "on", access_token: accessToken }, function(data) {
        updateStatus("on");
    });
}

function switchOff() {
    $.post(url, { params: "off", access_token: accessToken }, function(data) {
        updateStatus("off");
    });
}

function updateStatus(status) {
    var statusText = status === 'on' ? 'FOCO ENCENDIDO=ON' : 'FOCO APAGADO=OFF';
    document.getElementById('status').innerText = statusText;
    var checkbox = document.getElementById('checkbox');
    checkbox.checked = (status === 'on');
}

// Añadido
var progressBar = document.querySelector(".progress-bar");
var progress = progressBar.querySelector(".progress");
var textRange = progressBar.querySelector(".text-range");

// Establecer el valor inicial del medidor
progress.style.width = "0%";
textRange.textContent = "0%";

// Actualizar el valor del medidor
function updateProgress(weight) {
  // Obtener los rangos de peso
  var ranges = [
    { min: 0, max: 250, range: "Poco alimento" },
    { min: 250, max: 500, range: "Alimento adecuado" },
    { min: 500, max: 750, range: "Mucho alimento" },
  ];

  // Encontrar el rango correspondiente
  for (var i = 0; i < ranges.length; i++) {
    if (weight >= ranges[i].min && weight <= ranges[i].max) {
      // Actualizar el valor del medidor
      progress.style.width = (weight - ranges[i].min) / (ranges[i].max - ranges[i].min) * 100;
      textRange.textContent = ranges[i].range;
      break;
    }
  }
}

// Añadido
$.get("https://api.particle.io/v1/devices/3b001b001547313036303933/weight", function(data) {
  var weight = data.weight;
  updateProgress(weight);
});
</script>
</head>

<body>
<h1>On/Off Control</h1>

<p id="status"></p>
<input type="button" onClick="switchOn()" value="ON"/>
<input type="button" onClick="switchOff()" value="OFF"/>
    
    <input type="checkbox" id="checkbox" disabled/>


<div class="progress-bar">
  <div class="progress"></div>
  <div class="text-range"></div>
</div>
</body>
</html>
